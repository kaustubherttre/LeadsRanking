(this.webpackJsonpMatrix_Dashboard=this.webpackJsonpMatrix_Dashboard||[]).push([[117],{1266:function(e,t,a){"use strict";a.r(t);var n=a(5),i=a(39),l=a(40),o=a(121),s=a(42),r=a(41),d=a(0),u=a.n(d),c=a(1261),m=a(1262),h=a(1336),p=a(420),y=a(51),v=a.n(y),b=a(61),f=a(425),O=a(30),g=a(431),E=(a(496),a(430)),D=(a(427),a(90)),S=a(530),C=a(424),k=a(531),F=a(533),I=a(563),Q=a(532),T=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleChange=function(e,t){"FieldType"==e.target.id&&(n.FieldOptionsList.includes(e.target.value)?n.setState((function(){return{editFieldOptions:!1}})):n.setState((function(){return{editFieldOptions:!0}})));var a=n.state.formvalue;n.state.od;e.target&&"checkbox"==e.target.type?a[e.target.id]=e.target.checked:e._isAMomentObject?a[t]=e.format():a[e.target.id]="number"===e.target.type?parseInt(e.target.value):e.target.value,n.setState({formvalue:a,ModalValueChanged:!0})},n.state={isLoaded:!1,showModal:!1,items:[],store:[],activePage:1,root:"SurveyQuestionMaster",departmentId:"0",valid_sid:!0,ParentOption:"",PageTitle:"",FormTitle:"",formvalue:{},event:"",ModalValueChanged:!1,user:{},editFieldOptions:!1},n.handleRemove=n.handleRemove.bind(Object(o.a)(n)),n.handleClose=n.handleClose.bind(Object(o.a)(n)),n.handleShow=n.handleShow.bind(Object(o.a)(n)),n.handleSave=n.handleSave.bind(Object(o.a)(n)),n.handleAddNested=n.handleAddNested.bind(Object(o.a)(n)),n.selectedrow={QuestionText:"",FieldOptions:"",SurveyID:Object(D.i)("sid")},n.FieldOptionsList=["textarea","number","string","email","empty","link","embedded"],n.SurveyMasterList=[{name:"SurveyId",label:"SurveyId",type:"number"},{name:"SurveyName",label:"SurveyName",type:"string"}],n.columnlist=[{name:"QuestionID",label:"QuestionID",type:"number",searchable:!0,editable:!1},{name:"QuestionText",label:"QuestionText",type:"string",searchable:!0,required:!0},{name:"SurveyID",label:"SurveyID",type:"number",editable:!1},{name:"FieldType",label:"FieldType",type:"string",searchable:!0,editable:!1},{name:"FieldOptions",label:"FieldOptions",type:"string",searchable:!0,required:!0},{name:"IsRequired",label:"IsRequired",type:"bool",searchable:!0,required:!0}],n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(D.i)("sid");this.props.GetCommonData({limit:10,skip:0,root:this.state.root,order:1,cols:Object(D.a)(this.columnlist,"name"),con:[{SurveyID:e}],c:"L"}),this.props.GetCommonData({limit:10,skip:0,root:"SurveyMaster",cols:Object(D.a)(this.SurveyMasterList,"name"),con:[{SurveyId:e}],c:"L"}),setTimeout(function(){this.setState({user:Object(D.j)()})}.bind(this),500)}},{key:"componentWillReceiveProps",value:function(e){e.CommonData.isError||(e.CommonData.SurveyMaster&&e.CommonData.SurveyMaster[0]&&this.setState((function(){return{valid_sid:!1,PageTitle:e.CommonData.SurveyMaster[0].SurveyName}})),this.setState({items:e.CommonData[this.state.root]}),this.setState({store:e.CommonData}))}},{key:"fnDatatableCol",value:function(){var e=this,t=Object(D.e)(this.columnlist);return t.push({name:"Action",cell:function(t){return u.a.createElement(c.a,{"aria-label":"Basic example"},u.a.createElement(m.a,{variant:"secondary",onClick:function(){return e.handleEdit(t)}},u.a.createElement("i",{className:"fa fa-pencil-square-o","aria-hidden":"true"})),u.a.createElement(m.a,{variant:"secondary",onClick:function(){return e.handleAddNested(t)},disabled:"single select"!=t.FieldType&&"dropdown"!=t.FieldType},u.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"})),u.a.createElement(m.a,{variant:"secondary",onClick:function(){window.confirm("Are you sure you wish to delete this quesiton?")&&e.handleRemove(t)}},u.a.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})))}}),t}},{key:"handleRemove",value:function(e){this.props.DeleteData({root:this.state.root,query:{QuestionID:e.QuestionID}},(function(e){200===e.data.status?Object(E.b)("Question removed!",{type:"success"}):E.b.error("Question could not be removed")})),this.props.DeleteData({root:"SurveyNestedQuestionMaster",query:{NestedQuestionId:e.QuestionID}}),setTimeout(function(){var e=Object(D.i)("sid");this.props.GetCommonData({limit:10,skip:0,order:1,root:this.state.root,cols:Object(D.a)(this.columnlist,"name"),con:[{SurveyID:e}],c:"L"})}.bind(this),1e3)}},{key:"handleEdit",value:function(e){this.FieldOptionsList.includes(e.FieldType)?this.setState((function(){return{editFieldOptions:!1}})):this.setState((function(){return{editFieldOptions:!0}})),this.setState({od:Object.assign({},e,{}),formvalue:Object.assign({},e,{}),event:"Edit",showModal:!0,FormTitle:"Edit Question"})}},{key:"handleClose",value:function(){this.setState({showModal:!1})}},{key:"handleShow",value:function(){this.setState({formvalue:Object(n.a)({},this.selectedrow),event:"Add",showModal:!0,FormTitle:"Add New Question"})}},{key:"handleAddNested",value:function(e){this.setState({formvalue:Object(n.a)(Object(n.a)({},this.selectedrow),{},{ParentQuestionID:e.QuestionID}),event:"AddNested",ParentOption:e.FieldOptions,showModal:!0,FormTitle:"Add New Nested Question"})}},{key:"handleSave",value:function(){var e=this;if(document.getElementsByName("frmChatAgentConfigure").length>0&&document.getElementsByName("frmChatAgentConfigure")[0].reportValidity()){var t=JSON.parse(JSON.stringify(this.state.formvalue));console.log("formvalue",t),this.fnCleanData(t);var a,n,i=t.QuestionID;if(delete t.QuestionID,t.FieldOptions=t.FieldOptions.replace(/\s*,\s*/g,","),t.FieldOptions=t.FieldOptions.trim(),"single select"==t.FieldType&&(t.FieldType="radio"),"multi-select"==t.FieldType&&(t.FieldType="checkbox"),this.FieldOptionsList.includes(t.FieldType)&&(t.FieldOptions=""),t.ParentQuestionID&&(a=t.ParentQuestionID,n=t.ParentOption,console.log("---nested----",t.ParentQuestionID,t.ParentOption),delete t.ParentOption,delete t.ParentQuestionID),"Edit"==this.state.event){this.fnCleanData(t);this.props.UpdateData({root:this.state.root,body:t,querydata:{QuestionID:i},c:"L"},(function(e){Object(E.b)("Question Saved Successfully!",{type:"success"})}))}else t.CreatedOn=v()().format("YYYY-MM-DD HH:mm:ss"),this.props.InsertData({root:this.state.root,body:t,scope:!0},(function(t){if(200!=t.data.status)E.b.error(t.data.message);else if(a){var i=t.data.data.recordset[0][""];console.log("////////",n,a,i),e.props.InsertData({root:"SurveyNestedQuestionMaster",body:{NestedQuestionId:i,ParentQuestionId:a,SelectedOption:n}},(function(e){200!=e.data.status?E.b.error(e.data.message):Object(E.b)("Question Added Successfully!",{type:"success"})}))}else Object(E.b)("Question Added Successfully!",{type:"success"})})),console.log("---------",t);setTimeout(function(){var e=Object(D.i)("sid");this.props.GetCommonData({limit:10,skip:0,order:1,root:this.state.root,cols:Object(D.a)(this.columnlist,"name"),con:[{SurveyID:e}],c:"L"})}.bind(this),1e3),this.setState({showModal:!1})}return!1}},{key:"fnCleanData",value:function(e){}},{key:"render",value:function(){var e=this,t=this.fnDatatableCol(),a=this.state,n=a.items,i=a.PageTitle,l=a.showModal,o=a.FormTitle,s=a.formvalue,r=a.ModalValueChanged,d=a.event;if(console.log("renderitems",n,s),n)for(var c=0;c<n.length;c++)"radio"==n[c].FieldType&&(n[c].FieldType="single select"),"checkbox"==n[c].FieldType&&(n[c].FieldType="multi-select");return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"content"},u.a.createElement(E.a,null),u.a.createElement(S.a,null,u.a.createElement(C.a,{md:"12"},u.a.createElement(k.a,null,u.a.createElement(F.a,null,u.a.createElement(S.a,null,u.a.createElement(C.a,{md:10},u.a.createElement(I.a,{tag:"h4"},i)),u.a.createElement(C.a,{md:2},u.a.createElement(m.a,{disabled:this.state.valid_sid,variant:"primary",onClick:this.handleShow},"Add New Question")))),u.a.createElement(Q.a,null,u.a.createElement(g.a,{columns:t,data:n,extention:!0,export:!1,print:!1}))))),u.a.createElement(h.a,{show:l,onHide:this.handleClose,dialogClassName:"modal-90w"},u.a.createElement(h.a.Header,{closeButton:!0},u.a.createElement(h.a.Title,null,o)),u.a.createElement(h.a.Body,null,u.a.createElement(p.a,{name:"frmChatAgentConfigure"},u.a.createElement(S.a,null,this.columnlist.map((function(t){return"FieldType"==t.name?u.a.createElement(p.a.Group,{as:C.a,md:3,controlId:t.name,key:t.name},u.a.createElement(p.a.Label,null,t.label),u.a.createElement(p.a.Control,{as:"select",onChange:e.handleChange,defaultValue:s.FieldType,placeholder:"Select",required:!0},u.a.createElement("option",{key:0,value:"",disabled:!0,selected:!0},"Select your option"),u.a.createElement("option",{key:1,value:"string"},"string"),u.a.createElement("option",{key:2,value:"textarea"},"textarea"),u.a.createElement("option",{key:3,value:"multi-select"},"multi-select"),u.a.createElement("option",{key:4,value:"single select"},"single select"),u.a.createElement("option",{key:5,value:"number"},"number"),u.a.createElement("option",{key:6,value:"dropdown"},"dropdown"),u.a.createElement("option",{key:7,value:"email"},"email"),u.a.createElement("option",{key:8,value:"empty"},"empty"),u.a.createElement("option",{key:9,value:"link"},"link"),u.a.createElement("option",{key:10,value:"embedded"},"embedded"))):!("FieldOptions"==t.name&&!e.state.editFieldOptions)&&("SurveyID"!=t.name&&"QuestionID"!=t.name&&Object(D.f)(t,s,e.handleChange,d))})),"AddNested"==d&&u.a.createElement(p.a.Group,{as:C.a,md:3,controlId:"ParentOption",key:"ParentOption"},u.a.createElement(p.a.Label,null,"ParentOption"),u.a.createElement(p.a.Control,{as:"select",onChange:this.handleChange,placeholder:"Select",required:!0},u.a.createElement("option",{key:0,value:"",disabled:!0,selected:!0},"Select your option"),this.state.ParentOption.split(",").map((function(e,t){return u.a.createElement("option",{key:t+1,value:e},e)})))),"AddNested"==d&&u.a.createElement(p.a.Group,{as:C.a,md:2,controlId:"ParentQuestionID",key:"ParentQuestionID"},u.a.createElement(p.a.Label,null,"ParentQuestionID"),u.a.createElement(p.a.Control,{required:!0,disabled:!0,type:"number",onChange:this.handleChange,value:s.ParentQuestionID}))))),u.a.createElement(h.a.Footer,null,u.a.createElement(m.a,{variant:"secondary",onClick:this.handleClose},"Close"),u.a.createElement(f.If,{condition:r},u.a.createElement(f.Then,null,u.a.createElement("input",{type:"submit",value:"Save Changes",className:"btn btn-primary",onClick:this.handleSave})))))))}}]),a}(u.a.Component);t.default=Object(O.b)((function(e){return{CommonData:e.CommonData}}),{GetCommonData:b.g,InsertData:b.y,UpdateData:b.S,DeleteData:b.c})(T)}}]);
//# sourceMappingURL=117.12c0b109.chunk.js.map