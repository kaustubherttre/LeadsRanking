(this.webpackJsonpMatrix_Dashboard=this.webpackJsonpMatrix_Dashboard||[]).push([[108],{427:function(e,t,a){},683:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a(39),o=a(40),s=a(121),l=a(42),i=a(41),u=a(123),d=a(0),m=a.n(d),c=a(420),p=a(1262),h=a(51),v=a.n(h),y=a(61),I=a(30),g=a(430),b=(a(427),a(90)),f=a(424),D=a(530),E=a(531),C=a(533),Q=a(563),S=a(532),T=function e(t){var a,n=m.a.createElement("span",null,"*"),r=t.FieldOptions.split(","),o=t.items.filter((function(e){return e.QuestionID===t.NestedQuestionId}));return t.display&&("radio"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,key:t.QuestionID,controlId:t.QuestionID},m.a.createElement("div",null,m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n)),m.a.createElement("ul",{className:"survey-radio"},r.map((function(e,a){return m.a.createElement("li",{onClick:t.handleChange,value:e,name:t.QuestionID,type:"radio",className:t.formvalue[t.QuestionID]===e?"active-rating":""},e)}))))),"checkbox"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,key:t.QuestionID,controlId:t.QuestionID},m.a.createElement("div",null,m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n)),r.map((function(e,a){return m.a.createElement(c.a.Check,{onChange:t.handleChange,custom:!0,className:"survey-checkbox-radio",label:e,value:e,type:t.FieldType.toLowerCase(),name:t.QuestionID,id:e+"_"+t.FieldType.toLowerCase()})})))),"textarea"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,controlId:t.QuestionID,key:t.QuestionID},m.a.createElement("div",null,m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n)),m.a.createElement(c.a.Control,{required:t.IsRequired,type:"text",onChange:t.handleChange,as:"textarea",placeholder:"Enter"}))),"email"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,controlId:t.QuestionID,key:t.QuestionID},m.a.createElement("div",null,m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n)),m.a.createElement(c.a.Control,{required:t.IsRequired,type:"email",onChange:t.handleChange,placeholder:"Enter email"}))),"number"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,controlId:t.QuestionID,key:t.QuestionID},m.a.createElement("div",null,m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n)),m.a.createElement(c.a.Control,{required:t.IsRequired,type:"number",onChange:t.handleChange,placeholder:"Enter"}))),"dropdown"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,controlId:t.QuestionID,key:t.QuestionID},m.a.createElement("div",null,m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n)),m.a.createElement(c.a.Control,{as:"select",onChange:t.handleChange,placeholder:"Select",required:t.IsRequired},m.a.createElement("option",{key:"0_dropdown",value:"",disabled:!0,selected:!0},"Select your option"),r.map((function(e,t){return m.a.createElement("option",{key:t+1+"_dropdown",value:e},e)}))))),"string"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,key:t.QuestionID,controlId:t.QuestionID},m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n),m.a.createElement(c.a.Control,{required:t.IsRequired,type:"text",onChange:t.handleChange,placeholder:"Enter"}))),"empty"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,key:t.QuestionID,controlId:t.QuestionID},m.a.createElement(c.a.Label,null,t.QuestionText,t.IsRequired&&n))),"link"==t.FieldType.toLowerCase()&&(a=m.a.createElement(c.a.Group,{as:f.a,md:12,key:t.QuestionID,controlId:t.QuestionID},m.a.createElement("a",{target:"_blank",href:t.QuestionText},t.QuestionText))),"embedded"==t.FieldType.toLowerCase()&&(a=m.a.createElement("iframe",{src:t&&t.QuestionText,allow:"geolocation; microphone; camera",style:Object(u.a)({width:"100%",border:0,height:"250px"},"border","none")}))),m.a.createElement("div",null,a,o.map((function(a,n){return m.a.createElement(e,{QuestionID:a.QuestionID,QuestionText:a.QuestionText,FieldOptions:a.FieldOptions,FieldType:a.FieldType,IsRequired:a.IsRequired,SelectedOption:a.SelectedOption,NestedQuestionId:a.NestedQuestionId,items:t.items,display:t.formvalue[t.QuestionID]==t.SelectedOption&&0==n,formvalue:t.formvalue,handleChange:t.handleChange})})))},O=function(e){Object(l.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).handleChange=function(e,t){var a=n.state.formvalue;n.state.od;if(e.target&&"radio"==e.target.type)n.handleFormvalue(e.target.getAttribute("name")),a[e.target.getAttribute("name")]=e.target.getAttribute("value");else if(e.target&&"checkbox"==e.target.type)if(e.target.name in a){var r=a[e.target.name].indexOf(e.target.value);r>-1?(a[e.target.name].splice(r,1),0==a[e.target.name].length&&delete a[e.target.name]):a[e.target.name].push(e.target.value)}else a[e.target.name]=[e.target.value];else e._isAMomentObject?a[t]=e.format():(n.handleFormvalue(e.target.id),a[e.target.id]="number"===e.target.type?parseInt(e.target.value):e.target.value);n.setState({formvalue:a,ModalValueChanged:!0})},n.handleFormvalue=function(e){var t=n.state.formvalue,a=n.state.items;delete t[e];for(var r=0;r<a.length;r++)a[r].QuestionID==e&&0!=a[r].NestedQuestionId&&(console.log("-------------------",a[r].NestedQuestionId),n.handleFormvalue(a[r].NestedQuestionId));n.setState((function(){return{formvalue:t}}))},n.state={isLoaded:!1,showModal:!1,items:[],store:[],activePage:1,root:"SurveyQuestionMasterJoin",departmentId:"0",stepOnePart:1,saved:!1,PageTitle:"",PageDescription:"",FormTitle:"",formvalue:{},event:"",ModalValueChanged:!1,user:{}},n.handleClose=n.handleClose.bind(Object(s.a)(n)),n.handleShow=n.handleShow.bind(Object(s.a)(n)),n.handleSave=n.handleSave.bind(Object(s.a)(n)),n.handleFormvalue=n.handleFormvalue.bind(Object(s.a)(n)),n.selectedrow={QuestionText:"",FieldOptions:"",SurveyID:Object(b.i)("sid")},n.SurveyMasterList=[{name:"SurveyId",label:"SurveyId",type:"number"},{name:"SurveyName",label:"SurveyName",type:"string"},{name:"Description",label:"Description",type:"string"}],n.columnlist=[{name:"QuestionID",label:"QuestionID",type:"number",searchable:!0,editable:!1},{name:"QuestionText",label:"QuestionText",type:"string",searchable:!0,required:!0},{name:"SurveyID",label:"SurveyID",type:"number",editable:!1},{name:"FieldType",label:"FieldType",type:"string",searchable:!0,editable:!1},{name:"FieldOptions",label:"FieldOptions",type:"string",searchable:!0,required:!0},{name:"IsRequired",label:"IsRequired",type:"bool",searchable:!0,required:!0},{name:"SelectedOption",label:"SelectedOption",type:"string",searchable:!0,required:!0},{name:"NestedQuestionId",label:"NestedQuestionId",type:"number",searchable:!0,required:!0}],n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=Object(b.i)("sid"),t=Object(b.i)("u");this.props.GetCommonData({limit:10,skip:0,root:this.state.root,SurveyID:e,c:"L"},(function(e){})),this.props.GetCommonData({limit:10,skip:0,root:"SurveyMaster",cols:Object(b.a)(this.SurveyMasterList,"name"),con:[{SurveyId:e}],c:"R"}),t?this.props.GetCommonspData({root:"CheckSurveyAgent",c:"L",params:[{UserId:t,SurveyId:e}]},function(e){e.data&&e.data.data[0].length>0&&(console.log(e.data.data[0][0].Eligible,e.data.data[0][0].IsComplete),1==e.data.data[0][0].Eligible&&0==e.data.data[0][0].IsComplete?this.setState({stepOnePart:4}):1==e.data.data[0][0].Eligible&&1==e.data.data[0][0].IsComplete?this.setState({stepOnePart:3}):this.setState({stepOnePart:2}))}.bind(this)):this.setState({stepOnePart:2}),setTimeout(function(){this.setState({user:Object(b.j)()})}.bind(this),500)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.CommonData.isError||(e.CommonData.SurveyMaster&&e.CommonData.SurveyMaster[0]&&this.setState((function(){return{PageTitle:e.CommonData.SurveyMaster[0].SurveyName,PageDescription:e.CommonData.SurveyMaster[0].Description}})),this.setState((function(){return{items:e.CommonData[t.state.root]}})),this.setState({store:e.CommonData}))}},{key:"handleEdit",value:function(e){this.setState({od:Object.assign({},e,{}),formvalue:Object.assign({},e,{}),event:"Edit",showModal:!0,FormTitle:"Edit Survey"})}},{key:"handleClose",value:function(){this.setState({showModal:!1})}},{key:"handleShow",value:function(){this.setState({formvalue:Object(n.a)({},this.selectedrow),event:"Add",showModal:!0,FormTitle:"Add New Survey"})}},{key:"handleSave",value:function(e){e.preventDefault();var t=Object(b.i)("u"),a=Object(b.i)("sid");if(document.getElementsByName("frmChatAgentConfigure").length>0&&document.getElementsByName("frmChatAgentConfigure")[0].reportValidity()){var n=JSON.parse(JSON.stringify(this.state.formvalue));console.log("formvalue",n);for(var r=this.state.items,o=0;o<r.length;o++)if(r[o].IsRequired&&("radio"==r[o].FieldType||"checkbox"==r[o].FieldType)&&!n[r[o].QuestionID]&&document.getElementsByName(r[o].QuestionID).length>0)return void g.b.error("Please fill all the required fields!");if("Edit"==this.state.event);else{var s=!0;for(var l in n){var i={SurveyId:a,UserId:t,CreatedOn:v()().format("YYYY-MM-DD HH:mm:ss")};i.QuestionId=l,i.AnswerText=n[l],i.AnswerId=1,i.IsActive=1,this.props.InsertData({root:"SurveyResponse",body:i},(function(e){200!=e.data.status&&(s=!1)}))}if(s){this.props.UpdateData({root:"SurveyAgentMapping",body:{IsCompleted:1,UpdatedOn:v()().format("YYYY-MM-DD HH:mm:ss")},querydata:{UserId:t,SurveyId:a},c:"L"});alert("Form submitted successfully"),this.setState((function(){return{saved:!0}}))}else g.b.error("Cannot Submit Survey!")}setTimeout(function(){this.props.GetCommonData({limit:10,skip:0,root:this.state.root,cols:Object(b.a)(this.columnlist,"name"),con:[{SurveyID:a}],c:"L"})}.bind(this),1e3),this.setState({showModal:!1})}return!1}},{key:"renderSwitch",value:function(e,t){var a=this;if(1==e)return m.a.createElement("i",{className:"fa fa-spinner fa-spin"});if(2==e)return m.a.createElement("p",{className:"survey-response info"},"Invalid action");if(3==e)return m.a.createElement("p",{className:"survey-response info"},"Your survey response is already recorded");if(4==e){if(this.state.saved)return m.a.createElement("p",{className:"survey-response info"},"Your response is submitted successfully");this.state.nested;var n=this.state.formvalue,r={};return m.a.createElement(m.a.Fragment,null,this.state.PageDescription?m.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.PageDescription}}):null,m.a.createElement(c.a,{name:"frmChatAgentConfigure"},t&&t.map((function(e){return r[e.QuestionID]||(r[e.QuestionID]=0),r[e.QuestionID]=r[e.QuestionID]+1,m.a.createElement("div",null,!e.IsNestedQuestion&&m.a.createElement(T,{QuestionID:e.QuestionID,QuestionText:e.QuestionText,FieldOptions:e.FieldOptions,FieldType:e.FieldType,IsRequired:e.IsRequired,SelectedOption:e.SelectedOption,NestedQuestionId:e.NestedQuestionId,items:a.state.items,formvalue:n,display:1==r[e.QuestionID],handleChange:a.handleChange}))})),m.a.createElement(c.a.Group,{as:D.a},m.a.createElement(f.a,null,m.a.createElement(p.a,{type:"submit",onClick:this.handleSave},"Submit survey")))))}}},{key:"render",value:function(){var e=this.state,t=e.stepOnePart,a=e.items,n=e.PageTitle,r=(e.PageDescription,e.showModal,e.FormTitle,e.formvalue);e.ModalValueChanged,e.event;return console.log("renderitems",a,r),m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"content"},m.a.createElement(g.a,null),m.a.createElement(D.a,null,m.a.createElement(f.a,{md:"12"},m.a.createElement(E.a,{className:"surveyform col-md-6 col-xs-12"},m.a.createElement(C.a,null,m.a.createElement(D.a,null,m.a.createElement(f.a,{md:6,className:"col-md-12 text-center"},m.a.createElement(Q.a,{tag:"h3"},n)))),m.a.createElement(S.a,null,this.renderSwitch(t,a)))))))}}]),a}(m.a.Component);t.default=Object(I.b)((function(e){return{CommonData:e.CommonData}}),{GetCommonData:y.g,InsertData:y.y,UpdateData:y.S,GetCommonspData:y.h})(O)}}]);
//# sourceMappingURL=108.0f5052a7.chunk.js.map